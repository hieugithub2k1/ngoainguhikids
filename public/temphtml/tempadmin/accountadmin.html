<style>
    .dv-accounts-contents {
        padding: 10px;
    }

    .dv-accounts-contents .dv-title-filter {
        font-size: 22px;
        font-weight: 500;
    }

    .dv-accounts-contents .dv-title-filter:not(:first-child) {
        margin-top: 10px;
    }

    .dv-accounts-contents .dv-box {
        padding: 10px;
        background-color: white;
        border-radius: 5px;
        margin-top: 10px;
    }

    .dv-accounts-contents .dv-box-1>form {
        display: flex;
        flex-wrap: wrap;
        align-items: end;
        justify-content: space-between;
        gap: 10px;
    }

    .dv-accounts-contents .dv-box-1>form .form-group {
        flex: 1 1 calc(100% / 4 - 10px);
        display: flex;
        flex-direction: column;
        /* border: 1px solid #ccc; */
    }

    .dv-accounts-contents .dv-box-1>form .form-group>label {
        font-size: 16px;
        font-weight: 500;
        margin-bottom: 5px;
    }

    .dv-accounts-contents .dv-box-1>form .form-group>select {
        padding: 5px;
        border: none;
        outline: none;
        background-color: white;
        border: 1px solid #ccc;
        border-radius: 5px;
    }

    .dv-accounts-contents .dv-box-2>input {
        width: 100%;
        border-radius: 5px;
        outline: none;
        font-size: 16px;
        font-weight: 500;
    }

    .dv-accounts-contents .dv-table-accounts {
        width: 100%;
        border-collapse: collapse;
        margin-top: 10px;
        border-radius: 5px 5px 0 0;
        overflow: hidden;
        box-shadow: 0 0 5px 0 rgb(218, 218, 218);
    }

    .dv-accounts-contents .dv-table-accounts th {
        background-color: var(--mb-primary-color);
        font-size: 16px;
        font-weight: 500;
        padding: 10px;
        text-align: left;
        color: white;
    }

    .dv-accounts-contents .dv-table-accounts td {
        padding: 10px;
    }

    .dv-accounts-contents .dv-table-accounts tr:nth-child(even) {
        background-color: rgba(243, 243, 243, 0.5);
    }

    .dv-accounts-contents .dv-table-accounts th:first-child,
    .dv-accounts-contents .dv-table-accounts td:first-child {
        text-align: center;
        padding: 5px;
    }

    .dv-accounts-contents .dv-table-accounts td>input,
    .dv-accounts-contents .dv-table-accounts th>input {
        margin: 0;
        padding: 0;
        width: 20px;
        aspect-ratio: 1/1;
        border: none;
        outline: none;
    }

    .dv-accounts-contents .dv-box-3 .dv-actions {
        display: flex;
        justify-content: flex-end;
        align-items: end;
        gap: 10px;
        flex-wrap: wrap;

    }

    .dv-accounts-contents .dv-box-3 .dv-actions .formGroup {
        display: flex;
        flex-direction: column;
    }

    .dv-accounts-contents .dv-box-3 .dv-actions .formGroup>label {
        font-size: 16px;
        font-weight: 500;
        margin-bottom: 5px;
    }

    .dv-accounts-contents .dv-box-3 .dv-actions .formGroup>select {
        padding: 5px;
        border: none;
        outline: none;
        background-color: white;
        border: 1px solid #ccc;
        border-radius: 5px;
    }

    .dv-accounts-contents .dv-table-accounts .dv-profile {
        display: flex;
        align-items: center;
        gap: 10px;
    }

    .dv-accounts-contents .dv-table-accounts .dv-profile>img {
        width: 50px;
        aspect-ratio: 1/1;
        border-radius: 50%;
        object-fit: cover;
    }

    .dv-accounts-contents .dv-table-accounts .dv-profile>div {
        display: flex;
        flex-direction: column;
        gap: 5px;
    }

    .dv-accounts-contents .dv-table-accounts .dv-profile>div>span:first-child {
        font-size: 16px;
        font-weight: 500;
    }

    .dv-accounts-contents .dv-pagination-account {
        margin-top: 15px;
    }

    .dv-accounts-contents .dv-table-accounts .firstone>td>div,
    .dv-accounts-contents .dv-table-accounts .nodata>td>div {
        display: flex;
        justify-content: space-around;
        align-items: center;
        gap: 10px;
        padding: 20px;
        overflow: hidden;
    }

    .dv-accounts-contents .dv-table-accounts .firstone>td>div>svg,
    .dv-accounts-contents .dv-table-accounts .nodata>td>div>svg {
        width: 100px;
        height: 100px;
        fill: #6c63ff;
    }
</style>


<div class="dv-accounts-contents">
    <h4 class="dv-title-filter">Filter</h4>
    <div class="dv-box dv-box-1">
        <form action="" id="dv-form-filter">
            <div class="form-group">
                <label for="txtSearch">Class</label>
                <select class="form-control" name="idClass" id="id-class-filter">
                    <option value="0">All</option>
                    <option value="1">K198</option>
                    <option value="2">K199</option>
                </select>
            </div>
            <div class="form-group">
                <label for="txtSearch">Role</label>
                <select class="form-control" name="role" id="slRole">
                    <option value="">All</option>
                    <option value="0">Students</option>
                    <option value="1">Teacher</option>
                    <option value="2">Admin</option>
                </select>
            </div>
            <div class="form-group">
                <label for="txtSearch">Status</label>
                <select class="form-control" name="status" id="slStatus">
                    <option value="">All</option>
                    <option value="0">Pending</option>
                    <option value="1">Active</option>
                    <option value="2">Block</option>
                </select>
            </div>
            <div class="form-group">
                <button type="submit" class="btn btn-primary">Filter</button>
            </div>
        </form>
    </div>

    <h4 class="dv-title-filter">Search</h4>

    <div class="dv-box dv-box-2">
        <input type="text" placeholder="Search By Email" id="input-search-email">
    </div>

    <h4 class="dv-title-filter">List Account</h4>

    <div class="dv-box dv-box-3">
        <form class="dv-actions" id="form-update">
            <div class="formGroup">
                <label for="">Role</label>
                <select name="role" id="">
                    <option value="">None</option>
                    <option value="0">Student</option>
                    <option value="1">Teacher</option>
                    <option value="2">Admin</option>
                </select>
            </div>
            <div class="formGroup">
                <label for="">Status</label>
                <select name="status" id="">
                    <option value="">None</option>
                    <option value="0">Pending</option>
                    <option value="1">Active</option>
                    <option value="2">Block</option>
                </select>
            </div>
            <div class="formGroup">
                <button class="btn btn-primary">Update</button>
            </div>
        </form>
        <table class="dv-table-accounts">
            <thead>
                <tr>
                    <th><input type="checkbox" id="check-account-all"></th>
                    <th>Name</th>
                    <th>Class</th>
                    <th>Role</th>
                    <th>Status</th>
                    <th>createdAt</th>
                </tr>
            </thead>
            <tbody id="tbody-accounts">
                <tr class="firstone">
                    <td colspan="6">
                        <div>
                            <p> Please Filter </p>
                            <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
                                viewBox="0 0 934.98 571.14">
                                <path
                                    d="m733.52,89.21s-20.58,2.32-21.91,34.19c-1.11,26.56-3.37,41.36,7.44,46.9,3.86,1.98,8.4,2.15,12.53.8l44.1-14.5s.66-47.8-14.61-59.42-27.55-7.97-27.55-7.97h0Z"
                                    fill="#36344e" stroke-width="0" />
                                <polygon points="757.83 162.46 735.51 169.8 735.51 137.67 755.76 137.67 757.83 162.46"
                                    fill="#faafb2" stroke-width="0" />
                                <path id="uuid-ea0a1472-32fb-4242-948a-de51795c4bd3-46-44-46-72-78-43-43-46-311"
                                    d="m689.6,344.84c-1.21,7.36-6.12,12.64-10.96,11.79-4.85-.85-7.79-7.51-6.58-14.87.44-2.95,1.61-5.74,3.4-8.13l5.53-31.12,15.05,3.15-7.05,30.34c.93,2.87,1.14,5.9.61,8.84h0Z"
                                    fill="#faafb2" stroke-width="0" />
                                <polygon points="740.7 551.77 719.8 551.77 707.67 440.07 739.99 440.07 740.7 551.77"
                                    fill="#faafb2" stroke-width="0" />
                                <path
                                    d="m699.44,569.72c-2.2,0-4.16-.05-5.63-.19-5.55-.51-10.85-4.61-13.51-7-1.19-1.07-1.58-2.79-.96-4.27h0c.45-1.06,1.34-1.85,2.45-2.17l14.67-4.19,23.76-16.03.27.48c.1.18,2.43,4.38,3.21,7.22.3,1.08.22,1.98-.23,2.68-.31.48-.75.76-1.1.92.43.45,1.78,1.36,5.93,2.02,6.07.96,7.33-5.32,7.39-5.58l.04-.21.18-.12c2.88-1.86,4.66-2.7,5.27-2.52.38.11,1.02.31,2.74,17.41.17.54,1.38,4.47.56,8.24-.89,4.1-18.78,2.69-22.36,2.36-.1.01-13.49.96-22.67.96h-.01Z"
                                    fill="#36344e" stroke-width="0" />
                                <polygon points="787.93 551.77 767.02 551.77 754.9 440.07 787.21 440.07 787.93 551.77"
                                    fill="#faafb2" stroke-width="0" />
                                <path
                                    d="m746.67,569.72c-2.2,0-4.16-.05-5.63-.19-5.55-.51-10.85-4.61-13.51-7-1.19-1.07-1.58-2.79-.96-4.27h0c.45-1.06,1.34-1.85,2.45-2.17l14.67-4.19,23.76-16.03.27.48c.1.18,2.43,4.38,3.21,7.22.3,1.08.22,1.98-.23,2.68-.31.48-.75.76-1.1.92.43.45,1.78,1.36,5.93,2.02,6.07.96,7.33-5.32,7.39-5.58l.04-.21.18-.12c2.89-1.86,4.66-2.7,5.27-2.52.38.11,1.02.31,2.74,17.41.17.54,1.38,4.47.56,8.24-.89,4.1-18.78,2.69-22.36,2.36-.1.01-13.49.96-22.67.96h-.01Z"
                                    fill="#36344e" stroke-width="0" />
                                <polygon points="793.94 277.42 692.37 277.42 728.88 157.26 769.38 157.26 793.94 277.42"
                                    fill="#dfdfe0" stroke-width="0" />
                                <path
                                    d="m735.27,157.27s-25.23-.66-27.88,5.98-33.86,164.65-33.86,164.65h20.58l41.16-170.62h0Z"
                                    fill="#dfdfe0" stroke-width="0" />
                                <circle cx="738.27" cy="124.32" r="22.24" fill="#faafb2" stroke-width="0" />
                                <path
                                    d="m732.19,97.51s-12.24,49.7,1.37,72.93l-19.17-4.07s-7.43-54.39,7.51-64.28c0,0,10.29-4.58,10.29-4.58Z"
                                    fill="#36344e" stroke-width="0" />
                                <path
                                    d="m772.83,277.42h-66.66l-36.47,149.69c-.67,6.32,3.34,12.22,9.48,13.87,20.01,5.36,68.03,12.95,140.7-8.2,6.99-2.03,10.96-9.41,8.77-16.36l-55.82-139h0Z"
                                    fill="#36344e" stroke-width="0" />
                                <path
                                    d="m745.88,157.26l20.73-.91c8.98.68,17.1,5.56,21.91,13.17,14.65,23.16,42.06,71.97,17.59,78.66-32.26,8.81-47.89-40.24-47.89-40.24l-12.34-50.68h0Z"
                                    fill="#dfdfe0" stroke-width="0" />
                                <path id="uuid-298a271f-a3d1-4ea5-9ac1-ac2853dfa275-47-45-47-73-79-44-44-47-312"
                                    d="m738.77,171.8c-4.26-6.12-4.41-13.33-.35-16.1,4.07-2.77,10.82-.04,15.08,6.08,1.74,2.42,2.84,5.24,3.22,8.2l17.71,26.18-12.99,8.23-16.08-26.68c-2.67-1.41-4.93-3.44-6.59-5.91h0Z"
                                    fill="#faafb2" stroke-width="0" />
                                <polygon points="749.25 192.97 763.88 179.51 792.81 206.44 765.91 224.83 749.25 192.97"
                                    fill="#dfdfe0" stroke-width="0" />
                                <path
                                    d="m32.41,126.63h459.26c17.9,0,32.41,14.51,32.41,32.41h0c0,17.9-14.51,32.41-32.41,32.41H32.41c-17.9,0-32.41-14.51-32.41-32.41h0c0-17.9,14.51-32.41,32.41-32.41Z"
                                    fill="#6c63ff" stroke-width="0" />
                                <path
                                    d="m203.31,569.95c0,.66.53,1.19,1.19,1.19h729.29c.66,0,1.19-.53,1.19-1.19s-.53-1.19-1.19-1.19H204.5c-.66,0-1.19.53-1.19,1.19Z"
                                    fill="#484565" stroke-width="0" />
                                <path
                                    d="m424.62,93.95h95.35c2.28,0,4.12,1.84,4.12,4.11h0c0,2.27-1.84,4.11-4.12,4.11h-95.35c-2.28,0-4.12-1.84-4.12-4.11h0c0-2.27,1.84-4.11,4.12-4.11Z"
                                    fill="#dfdfe0" stroke-width="0" />
                                <path
                                    d="m4.12,0h95.35c2.28,0,4.12,1.84,4.12,4.11h0c0,2.27-1.84,4.11-4.12,4.11H4.12C1.84,8.23,0,6.39,0,4.11h0C0,1.84,1.84,0,4.12,0Z"
                                    fill="#dfdfe0" stroke-width="0" />
                                <path
                                    d="m4.12,35.91h279.87c2.28,0,4.12,1.84,4.12,4.12h0c0,2.27-1.84,4.11-4.12,4.11H4.12c-2.28,0-4.12-1.84-4.12-4.11h0c0-2.27,1.84-4.12,4.12-4.12Z"
                                    fill="#dfdfe0" stroke-width="0" />
                                <path
                                    d="m233.77,260.88c0,21.56,17.48,39.04,39.04,39.04,6.53,0,12.68-1.6,18.08-4.43l37.83,60c2.32,3.67,7.27,4.59,10.75,1.99h0c3.25-2.43,3.95-7.01,1.58-10.31l-41.61-57.75c7.63-7.13,12.41-17.28,12.41-28.54,0-21.56-17.48-39.04-39.04-39.04s-39.04,17.48-39.04,39.04Zm5.36,0c0-18.6,15.08-33.69,33.69-33.69s33.69,15.08,33.69,33.69c0,18.6-15.08,33.69-33.69,33.69-18.6,0-33.69-15.08-33.69-33.69Z"
                                    fill="#484662" stroke-width="0" />
                            </svg>
                        </div>
                    </td>
                </tr>
        </table>
        <div class="dv-pagination-account"></div>
    </div>


</div>





<script type="module">
    import { mbNotification, mbConfirm, mbLoading, mbFetch, mbPagination, mbFormData } from './public/js/allmodule.js';

    const divRoot = document.getElementById('root');
    // divRoot.innerHTML = '';

    // đầu tiên là phải lấy các khóa học để render ra Filter

    const idclassfilter = document.getElementById('id-class-filter');
    (async () => {
        let dataResponse = [];
        try {
            mbLoading(true);
            dataResponse = await mbFetch('admin/accounts/getClassActive');
            while (idclassfilter.firstChild) {
                idclassfilter.removeChild(idclassfilter.firstChild);
            }
            let option = document.createElement('option');
            option.value = '';
            option.textContent = 'All';
            idclassfilter.appendChild(option);
            dataResponse.forEach(item => {
                let option = document.createElement('option');
                option.value = item.id;
                option.textContent = item.className;
                idclassfilter.appendChild(option);
            });
        } catch (e) {
            console.log(e);
        } finally {
            mbLoading(false);
        }
    })();


    // variable global

    let objectFilter = {};
    const ojectPagination = {
        currentPage: 1,
        limit: 20
    };
    let selectedIds = [];
    let dataAccounts = {
        accounts: [],
        totalPages: 0
    };
    // handle filter

    const formFilter = document.getElementById('dv-form-filter');
    formFilter.addEventListener('submit', async (e) => {
        e.preventDefault();
        let formData = mbFormData(formFilter);
        objectFilter = {};
        for (let key in formData) {
            if (formData[key] === '') {
                delete formData[key];
            } else {
                objectFilter[key] = parseInt(formData[key]);
            }
        }
        getAccountsFilter();
    });

    getAccountsFilter();
    async function getAccountsFilter() {
        const url = "admin/accounts/getAccountsFilter/" + ojectPagination.currentPage + "/" + ojectPagination.limit;
        try {
            mbLoading(true);
            const dataRes = await mbFetch(url, objectFilter);
            dataAccounts = dataRes;
            renderAccounts(dataRes.accounts, dataRes.totalPages);
        } catch (e) {
            console.log(e);
        } finally {
            mbLoading(false);
        }
    }


    function renderAccounts(data, totalPages = null) {
        selectedIds = [];
        const tbodyaccounts = document.getElementById('tbody-accounts');
        while (tbodyaccounts.firstChild) {
            tbodyaccounts.removeChild(tbodyaccounts.firstChild);
        }

        if (data.length === 0) {
            tbodyaccounts.appendChild(trComponentEmpty());
            return;
        }

        data.forEach(item => {
            tbodyaccounts.appendChild(trComponent(item));
        });
        const dvPaginationAccount = document.querySelector('.dv-pagination-account');
        const paginationBox = mbPagination(ojectPagination.currentPage, totalPages);
        while (dvPaginationAccount.firstChild) {
            dvPaginationAccount.removeChild(dvPaginationAccount.firstChild);
        }

        if (!totalPages || totalPages === 1) {
            return;
        }

        dvPaginationAccount.appendChild(paginationBox);
        [...paginationBox.querySelectorAll('a')].forEach(item => {
            item.addEventListener('click', function (e) {
                e.preventDefault();
                const page = parseInt(this.dataset.page);
                ojectPagination.currentPage = page;
                getAccountsFilter();
            });
        });
    }

    function trComponent(data) {
        const linkimg = data.avatar ? data.avatar : './public/img/default_profile.jpg';
        let className = "";
        if (data.className === null) {
            className = "No Class";
        } else {
            className = data.className.split(', ').join('<br>');
        }
        const roleName = ['Students', 'Teacher', 'Admin'];
        const statusName = ['Pending', 'Active', 'Block'];
        const statusColor = ['#ff5700', 'green', 'red'];
        const tr = document.createElement('tr');
        tr.innerHTML = `
                    <td><input type="checkbox" data-id="${data.id}" class="check-account"></td>
                    <td>
                        <div class="dv-profile">
                            <img src="${linkimg}" alt="">
                            <div>
                                <span>${data.fullName}</span>
                                <span>${data.email}</span>
                            </div>
                        </div>
                    </td>
                    <td>
                        <p>${className}</p>
                    </td>
                    <td>${roleName[data.roles]}</td>
                    <td style="color: ${statusColor[data.statuss]}">${statusName[data.statuss]}</td>
                    <td>${data.createdAt}</td>
        `;
        const input = tr.querySelector('input[type="checkbox"]');
        input.onchange = (e) => {
            const id = parseInt(input.dataset.id);
            if (e.target.checked) {
                if (!selectedIds.includes(id)) {
                    selectedIds.push(id);
                }
            } else {
                selectedIds = selectedIds.filter(selectedId => selectedId !== id);
            }
            console.log(selectedIds);
        }
        return tr;
    }

    function trComponentEmpty() {
        const tr = document.createElement('tr');
        tr.classList.add('nodata');
        tr.innerHTML = `
                    <td colspan="6">
                        <div>
                            <p>No Data</p>
                            <svg xmlns="http://www.w3.org/2000/svg" data-name="Layer 1" viewBox="0 0 647.63626 632.17383" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M687.3279,276.08691H512.81813a15.01828,15.01828,0,0,0-15,15v387.85l-2,.61005-42.81006,13.11a8.00676,8.00676,0,0,1-9.98974-5.31L315.678,271.39691a8.00313,8.00313,0,0,1,5.31006-9.99l65.97022-20.2,191.25-58.54,65.96972-20.2a7.98927,7.98927,0,0,1,9.99024,5.3l32.5498,106.32Z" transform="translate(-276.18187 -133.91309)" fill="#f2f2f2"/><path d="M725.408,274.08691l-39.23-128.14a16.99368,16.99368,0,0,0-21.23-11.28l-92.75,28.39L380.95827,221.60693l-92.75,28.4a17.0152,17.0152,0,0,0-11.28028,21.23l134.08008,437.93a17.02661,17.02661,0,0,0,16.26026,12.03,16.78926,16.78926,0,0,0,4.96972-.75l63.58008-19.46,2-.62v-2.09l-2,.61-64.16992,19.65a15.01489,15.01489,0,0,1-18.73-9.95l-134.06983-437.94a14.97935,14.97935,0,0,1,9.94971-18.73l92.75-28.4,191.24024-58.54,92.75-28.4a15.15551,15.15551,0,0,1,4.40966-.66,15.01461,15.01461,0,0,1,14.32032,10.61l39.0498,127.56.62012,2h2.08008Z" transform="translate(-276.18187 -133.91309)" fill="#3f3d56"/><path d="M398.86279,261.73389a9.0157,9.0157,0,0,1-8.61133-6.3667l-12.88037-42.07178a8.99884,8.99884,0,0,1,5.9712-11.24023l175.939-53.86377a9.00867,9.00867,0,0,1,11.24072,5.9707l12.88037,42.07227a9.01029,9.01029,0,0,1-5.9707,11.24072L401.49219,261.33887A8.976,8.976,0,0,1,398.86279,261.73389Z" transform="translate(-276.18187 -133.91309)" fill="#6c63ff"/><circle cx="190.15351" cy="24.95465" r="20" fill="#6c63ff"/><circle cx="190.15351" cy="24.95465" r="12.66462" fill="#fff"/><path d="M878.81836,716.08691h-338a8.50981,8.50981,0,0,1-8.5-8.5v-405a8.50951,8.50951,0,0,1,8.5-8.5h338a8.50982,8.50982,0,0,1,8.5,8.5v405A8.51013,8.51013,0,0,1,878.81836,716.08691Z" transform="translate(-276.18187 -133.91309)" fill="#e6e6e6"/><path d="M723.31813,274.08691h-210.5a17.02411,17.02411,0,0,0-17,17v407.8l2-.61v-407.19a15.01828,15.01828,0,0,1,15-15H723.93825Zm183.5,0h-394a17.02411,17.02411,0,0,0-17,17v458a17.0241,17.0241,0,0,0,17,17h394a17.0241,17.0241,0,0,0,17-17v-458A17.02411,17.02411,0,0,0,906.81813,274.08691Zm15,475a15.01828,15.01828,0,0,1-15,15h-394a15.01828,15.01828,0,0,1-15-15v-458a15.01828,15.01828,0,0,1,15-15h394a15.01828,15.01828,0,0,1,15,15Z" transform="translate(-276.18187 -133.91309)" fill="#3f3d56"/><path d="M801.81836,318.08691h-184a9.01015,9.01015,0,0,1-9-9v-44a9.01016,9.01016,0,0,1,9-9h184a9.01016,9.01016,0,0,1,9,9v44A9.01015,9.01015,0,0,1,801.81836,318.08691Z" transform="translate(-276.18187 -133.91309)" fill="#6c63ff"/><circle cx="433.63626" cy="105.17383" r="20" fill="#6c63ff"/><circle cx="433.63626" cy="105.17383" r="12.18187" fill="#fff"/></svg>
                        </div>
                    </td>
        `;
        return tr;
    }

    const checkaccountall = document.getElementById('check-account-all');
    checkaccountall.addEventListener('change', (e) => {
        const checkaccounts = document.querySelectorAll('.check-account');
        checkaccounts.forEach(item => {
            item.checked = e.target.checked;
            const id = parseInt(item.dataset.id);
            if (e.target.checked) {
                if (!selectedIds.includes(id)) {
                    selectedIds.push(id);
                }
            } else {
                selectedIds = [];
            }
        });
    });


    const formUpdate = document.getElementById('form-update');
    formUpdate.addEventListener('submit', async (e) => {
        e.preventDefault();
        if (selectedIds.length === 0) {
            mbNotification('Warrning', 'Please select account to update', 3);
            return;
        }
        const formData = mbFormData(formUpdate);
        const dataReq = {
            arrid: selectedIds,
        };
        for (let key in formData) {
            if (formData[key] === '') {
                delete formData[key];
            } else {
                dataReq[key] = parseInt(formData[key]);
            }
        }

        if (dataReq.role === undefined && dataReq.status === undefined) {
            mbNotification('Warrning', 'Please select action to update', 3);
            return;
        }

        try {
            mbLoading(true);
            const dataRes = await mbFetch('admin/accounts/updateRoleAndStatus', dataReq);

            if (dataRes.error) {
                mbNotification('Error', dataRes.error, 3);
            } else {
                mbNotification('Success', dataRes.message, 1);
                getAccountsFilter();
                formUpdate.reset();
            }
        } catch (e) {
            console.log(e);
        } finally {
            mbLoading(false);
        }
    });

    const inputsearchemail = document.getElementById('input-search-email');
    let timeout = null;
    inputsearchemail.addEventListener('input', () => {
        clearTimeout(timeout);
        timeout = setTimeout(() => {
            getAccountByEmail(inputsearchemail.value);
        }, 500);
    });

    async function getAccountByEmail(email) {
        if (email === '') {
            renderAccounts(dataAccounts.accounts, dataAccounts.totalPages);
            return;
        }
        try {
            mbLoading(true);
            const dataRes = await mbFetch('admin/accounts/getAccountsByEmail', { email: email });
            renderAccounts(dataRes);
        } catch (e) {
            console.log(e);
        } finally {
            mbLoading(false);
        }
    }



</script>